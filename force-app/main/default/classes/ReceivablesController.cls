public class ReceivablesController {
	public static String JSONExample = '{"RECEIVABLES":[{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-12-01","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-12-11","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-12-25","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"}]}';
    public static String JSONExampleMany = '{"RECEIVABLES":[{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-08-26","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-02","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-09","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-08-26","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-02","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-09","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-08-26","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-02","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-09","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-08-26","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-02","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-09","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-08-26","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-02","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-09","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"001","DATE":"2017-08-05","PAYMENT_DUE":"2017-08-26","VALUE":"358.50","CORRECTED_VALUE":"358.50","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"002","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-02","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"},{"CLIENT_CODE":"0000100561","NAME":"E MICHELIN CIA LTDA EPP","SALESDOCUMENT":"2100126322","INSTALLMENT":"003","DATE":"2017-08-05","PAYMENT_DUE":"2017-09-09","VALUE":"347.95","CORRECTED_VALUE":"347.95","TYPE":"DF","INVOICE_NUMBER":"001114424-1"}]}';
  
    @AuraEnabled
    public static String getReceivables(Id accountId){
        //return JSONExampleMany;
		System.debug(accountId);        
        
        AccountAreaSales__c av = [SELECT Id, AccountLkp__r.CodeCustomerTxt__c FROM AccountAreaSales__C WHERE Id = :accountId];
        //Account acc = [SELECT Id, CodeCustomerTxt__c FROM Account WHERE Id = :accountId];
        List<String> accountCodeList = new List<String>();
        
        if(av.AccountLkp__r.CodeCustomerTxt__c != null){
            accountCodeList.add(av.AccountLkp__r.CodeCustomerTxt__c.leftPad(10, '0'));
            System.debug('#Codigo SAP: '+av.AccountLkp__r.CodeCustomerTxt__c);
            //accountCodeList.add('0000100944');
        }
        else{
            System.debug('CÃ³digo SAP em branco');
            accountCodeList.add('0000000000');
        }
        
        HTTPResponse res = SAPInteg.getReceivables(accountCodeList);
        return res.getBody();                    

       	/*Map<String, Object> jsonObj = (Map<String, Object>)JSON.deserializeUntyped(JSONExample); 
        system.debug(JSONExample);
        
        List<Object> listReceivable = (List<Object>) jsonObj.get('RECEIVABLES');
        system.debug(listReceivable);
        for(Object receivable : listReceivable){
            Map<String, Object> returnMap = (Map<String, Object>) receivable;
            
            System.debug((String)returnMap.get('PAYMENT_DUE'));
        }  
        
        return listReceivable;*/
    }   
    
    @AuraEnabled
    public static Integer calcDelay(String strDate1){
        Date date1 = Date.valueOf(strDate1);
        //System.debug(date1);
        Integer diff = date1.daysBetween(System.today());
        //System.debug(diff);
        return diff;
    }
}