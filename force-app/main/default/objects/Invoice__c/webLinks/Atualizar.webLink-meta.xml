<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Atualizar</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Atualizar</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/35.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/35.0/apex.js&quot;)} 
{!REQUIRESCRIPT(&apos;//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js&apos;)} 
{!REQUIRESCRIPT(&apos;//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js&apos;)}

/*
* jQuery BlockUI; v20141123
* http://jquery.malsup.com/block/
* Copyright (c) 2014 M. Alsup; Dual licensed: MIT/GPL
*/
(function(){&quot;use strict&quot;;function e(e){function o(o,i){var s,h,k=o==window,v=i&amp;&amp;void 0!==i.message?i.message:void 0;if(i=e.extend({},e.blockUI.defaults,i||{}),!i.ignoreIfBlocked||!e(o).data(&quot;blockUI.isBlocked&quot;)){if(i.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,i.overlayCSS||{}),s=e.extend({},e.blockUI.defaults.css,i.css||{}),i.onOverlayClick&amp;&amp;(i.overlayCSS.cursor=&quot;pointer&quot;),h=e.extend({},e.blockUI.defaults.themedCSS,i.themedCSS||{}),v=void 0===v?i.message:v,k&amp;&amp;b&amp;&amp;t(window,{fadeOut:0}),v&amp;&amp;&quot;string&quot;!=typeof v&amp;&amp;(v.parentNode||v.jquery)){var y=v.jquery?v[0]:v,m={};e(o).data(&quot;blockUI.history&quot;,m),m.el=y,m.parent=y.parentNode,m.display=y.style.display,m.position=y.style.position,m.parent&amp;&amp;m.parent.removeChild(y)}e(o).data(&quot;blockUI.onUnblock&quot;,i.onUnblock);var g,I,w,U,x=i.baseZ;g=r||i.forceIframe?e(&apos;&lt;iframe class=&quot;blockUI&quot; style=&quot;z-index:&apos;+x++ +&apos;;display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0&quot; src=&quot;&apos;+i.iframeSrc+&apos;&quot;&gt;&lt;/iframe&gt;&apos;):e(&apos;&lt;div class=&quot;blockUI&quot; style=&quot;display:none&quot;&gt;&lt;/div&gt;&apos;),I=i.theme?e(&apos;&lt;div class=&quot;blockUI blockOverlay ui-widget-overlay&quot; style=&quot;z-index:&apos;+x++ +&apos;;display:none&quot;&gt;&lt;/div&gt;&apos;):e(&apos;&lt;div class=&quot;blockUI blockOverlay&quot; style=&quot;z-index:&apos;+x++ +&apos;;display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0&quot;&gt;&lt;/div&gt;&apos;),i.theme&amp;&amp;k?(U=&apos;&lt;div class=&quot;blockUI &apos;+i.blockMsgClass+&apos; blockPage ui-dialog ui-widget ui-corner-all&quot; style=&quot;z-index:&apos;+(x+10)+&apos;;display:none;position:fixed&quot;&gt;&apos;,i.title&amp;&amp;(U+=&apos;&lt;div class=&quot;ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle&quot;&gt;&apos;+(i.title||&quot;&amp;nbsp;&quot;)+&quot;&lt;/div&gt;&quot;),U+=&apos;&lt;div class=&quot;ui-widget-content ui-dialog-content&quot;&gt;&lt;/div&gt;&apos;,U+=&quot;&lt;/div&gt;&quot;):i.theme?(U=&apos;&lt;div class=&quot;blockUI &apos;+i.blockMsgClass+&apos; blockElement ui-dialog ui-widget ui-corner-all&quot; style=&quot;z-index:&apos;+(x+10)+&apos;;display:none;position:absolute&quot;&gt;&apos;,i.title&amp;&amp;(U+=&apos;&lt;div class=&quot;ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle&quot;&gt;&apos;+(i.title||&quot;&amp;nbsp;&quot;)+&quot;&lt;/div&gt;&quot;),U+=&apos;&lt;div class=&quot;ui-widget-content ui-dialog-content&quot;&gt;&lt;/div&gt;&apos;,U+=&quot;&lt;/div&gt;&quot;):U=k?&apos;&lt;div class=&quot;blockUI &apos;+i.blockMsgClass+&apos; blockPage&quot; style=&quot;z-index:&apos;+(x+10)+&apos;;display:none;position:fixed&quot;&gt;&lt;/div&gt;&apos;:&apos;&lt;div class=&quot;blockUI &apos;+i.blockMsgClass+&apos; blockElement&quot; style=&quot;z-index:&apos;+(x+10)+&apos;;display:none;position:absolute&quot;&gt;&lt;/div&gt;&apos;,w=e(U),v&amp;&amp;(i.theme?(w.css(h),w.addClass(&quot;ui-widget-content&quot;)):w.css(s)),i.theme||I.css(i.overlayCSS),I.css(&quot;position&quot;,k?&quot;fixed&quot;:&quot;absolute&quot;),(r||i.forceIframe)&amp;&amp;g.css(&quot;opacity&quot;,0);var C=[g,I,w],S=k?e(&quot;body&quot;):e(o);e.each(C,function(){this.appendTo(S)}),i.theme&amp;&amp;i.draggable&amp;&amp;e.fn.draggable&amp;&amp;w.draggable({handle:&quot;.ui-dialog-titlebar&quot;,cancel:&quot;li&quot;});var O=f&amp;&amp;(!e.support.boxModel||e(&quot;object,embed&quot;,k?null:o).length&gt;0);if(u||O){if(k&amp;&amp;i.allowBodyStretch&amp;&amp;e.support.boxModel&amp;&amp;e(&quot;html,body&quot;).css(&quot;height&quot;,&quot;100%&quot;),(u||!e.support.boxModel)&amp;&amp;!k)var E=d(o,&quot;borderTopWidth&quot;),T=d(o,&quot;borderLeftWidth&quot;),M=E?&quot;(0 - &quot;+E+&quot;)&quot;:0,B=T?&quot;(0 - &quot;+T+&quot;)&quot;:0;e.each(C,function(e,o){var t=o[0].style;if(t.position=&quot;absolute&quot;,2&gt;e)k?t.setExpression(&quot;height&quot;,&quot;Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:&quot;+i.quirksmodeOffsetHack+&apos;) + &quot;px&quot;&apos;):t.setExpression(&quot;height&quot;,&apos;this.parentNode.offsetHeight + &quot;px&quot;&apos;),k?t.setExpression(&quot;width&quot;,&apos;jQuery.support.boxModel &amp;&amp; document.documentElement.clientWidth || document.body.clientWidth + &quot;px&quot;&apos;):t.setExpression(&quot;width&quot;,&apos;this.parentNode.offsetWidth + &quot;px&quot;&apos;),B&amp;&amp;t.setExpression(&quot;left&quot;,B),M&amp;&amp;t.setExpression(&quot;top&quot;,M);else if(i.centerY)k&amp;&amp;t.setExpression(&quot;top&quot;,&apos;(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + &quot;px&quot;&apos;),t.marginTop=0;else if(!i.centerY&amp;&amp;k){var n=i.css&amp;&amp;i.css.top?parseInt(i.css.top,10):0,s=&quot;((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + &quot;+n+&apos;) + &quot;px&quot;&apos;;t.setExpression(&quot;top&quot;,s)}})}if(v&amp;&amp;(i.theme?w.find(&quot;.ui-widget-content&quot;).append(v):w.append(v),(v.jquery||v.nodeType)&amp;&amp;e(v).show()),(r||i.forceIframe)&amp;&amp;i.showOverlay&amp;&amp;g.show(),i.fadeIn){var j=i.onBlock?i.onBlock:c,H=i.showOverlay&amp;&amp;!v?j:c,z=v?j:c;i.showOverlay&amp;&amp;I._fadeIn(i.fadeIn,H),v&amp;&amp;w._fadeIn(i.fadeIn,z)}else i.showOverlay&amp;&amp;I.show(),v&amp;&amp;w.show(),i.onBlock&amp;&amp;i.onBlock.bind(w)();if(n(1,o,i),k?(b=w[0],p=e(i.focusableElements,b),i.focusInput&amp;&amp;setTimeout(l,20)):a(w[0],i.centerX,i.centerY),i.timeout){var W=setTimeout(function(){k?e.unblockUI(i):e(o).unblock(i)},i.timeout);e(o).data(&quot;blockUI.timeout&quot;,W)}}}function t(o,t){var s,l=o==window,a=e(o),d=a.data(&quot;blockUI.history&quot;),c=a.data(&quot;blockUI.timeout&quot;);c&amp;&amp;(clearTimeout(c),a.removeData(&quot;blockUI.timeout&quot;)),t=e.extend({},e.blockUI.defaults,t||{}),n(0,o,t),null===t.onUnblock&amp;&amp;(t.onUnblock=a.data(&quot;blockUI.onUnblock&quot;),a.removeData(&quot;blockUI.onUnblock&quot;));var r;r=l?e(&quot;body&quot;).children().filter(&quot;.blockUI&quot;).add(&quot;body &gt; .blockUI&quot;):a.find(&quot;&gt;.blockUI&quot;),t.cursorReset&amp;&amp;(r.length&gt;1&amp;&amp;(r[1].style.cursor=t.cursorReset),r.length&gt;2&amp;&amp;(r[2].style.cursor=t.cursorReset)),l&amp;&amp;(b=p=null),t.fadeOut?(s=r.length,r.stop().fadeOut(t.fadeOut,function(){0===--s&amp;&amp;i(r,d,t,o)})):i(r,d,t,o)}function i(o,t,i,n){var s=e(n);if(!s.data(&quot;blockUI.isBlocked&quot;)){o.each(function(){this.parentNode&amp;&amp;this.parentNode.removeChild(this)}),t&amp;&amp;t.el&amp;&amp;(t.el.style.display=t.display,t.el.style.position=t.position,t.el.style.cursor=&quot;default&quot;,t.parent&amp;&amp;t.parent.appendChild(t.el),s.removeData(&quot;blockUI.history&quot;)),s.data(&quot;blockUI.static&quot;)&amp;&amp;s.css(&quot;position&quot;,&quot;static&quot;),&quot;function&quot;==typeof i.onUnblock&amp;&amp;i.onUnblock(n,i);var l=e(document.body),a=l.width(),d=l[0].style.width;l.width(a-1).width(a),l[0].style.width=d}}function n(o,t,i){var n=t==window,l=e(t);if((o||(!n||b)&amp;&amp;(n||l.data(&quot;blockUI.isBlocked&quot;)))&amp;&amp;(l.data(&quot;blockUI.isBlocked&quot;,o),n&amp;&amp;i.bindEvents&amp;&amp;(!o||i.showOverlay))){var a=&quot;mousedown mouseup keydown keypress keyup touchstart touchend touchmove&quot;;o?e(document).bind(a,i,s):e(document).unbind(a,s)}}function s(o){if(&quot;keydown&quot;===o.type&amp;&amp;o.keyCode&amp;&amp;9==o.keyCode&amp;&amp;b&amp;&amp;o.data.constrainTabKey){var t=p,i=!o.shiftKey&amp;&amp;o.target===t[t.length-1],n=o.shiftKey&amp;&amp;o.target===t[0];if(i||n)return setTimeout(function(){l(n)},10),!1}var s=o.data,a=e(o.target);return a.hasClass(&quot;blockOverlay&quot;)&amp;&amp;s.onOverlayClick&amp;&amp;s.onOverlayClick(o),a.parents(&quot;div.&quot;+s.blockMsgClass).length&gt;0?!0:0===a.parents().children().filter(&quot;div.blockUI&quot;).length}function l(e){if(p){var o=p[e===!0?p.length-1:0];o&amp;&amp;o.focus()}}function a(e,o,t){var i=e.parentNode,n=e.style,s=(i.offsetWidth-e.offsetWidth)/2-d(i,&quot;borderLeftWidth&quot;),l=(i.offsetHeight-e.offsetHeight)/2-d(i,&quot;borderTopWidth&quot;);o&amp;&amp;(n.left=s&gt;0?s+&quot;px&quot;:&quot;0&quot;),t&amp;&amp;(n.top=l&gt;0?l+&quot;px&quot;:&quot;0&quot;)}function d(o,t){return parseInt(e.css(o,t),10)||0}e.fn._fadeIn=e.fn.fadeIn;var c=e.noop||function(){},r=/MSIE/.test(navigator.userAgent),u=/MSIE 6.0/.test(navigator.userAgent)&amp;&amp;!/MSIE 8.0/.test(navigator.userAgent);document.documentMode||0;var f=e.isFunction(document.createElement(&quot;div&quot;).style.setExpression);e.blockUI=function(e){o(window,e)},e.unblockUI=function(e){t(window,e)},e.growlUI=function(o,t,i,n){var s=e(&apos;&lt;div class=&quot;growlUI&quot;&gt;&lt;/div&gt;&apos;);o&amp;&amp;s.append(&quot;&lt;h1&gt;&quot;+o+&quot;&lt;/h1&gt;&quot;),t&amp;&amp;s.append(&quot;&lt;h2&gt;&quot;+t+&quot;&lt;/h2&gt;&quot;),void 0===i&amp;&amp;(i=3e3);var l=function(o){o=o||{},e.blockUI({message:s,fadeIn:o.fadeIn!==void 0?o.fadeIn:700,fadeOut:o.fadeOut!==void 0?o.fadeOut:1e3,timeout:o.timeout!==void 0?o.timeout:i,centerY:!1,showOverlay:!1,onUnblock:n,css:e.blockUI.defaults.growlCSS})};l(),s.css(&quot;opacity&quot;),s.mouseover(function(){l({fadeIn:0,timeout:3e4});var o=e(&quot;.blockMsg&quot;);o.stop(),o.fadeTo(300,1)}).mouseout(function(){e(&quot;.blockMsg&quot;).fadeOut(1e3)})},e.fn.block=function(t){if(this[0]===window)return e.blockUI(t),this;var i=e.extend({},e.blockUI.defaults,t||{});return this.each(function(){var o=e(this);i.ignoreIfBlocked&amp;&amp;o.data(&quot;blockUI.isBlocked&quot;)||o.unblock({fadeOut:0})}),this.each(function(){&quot;static&quot;==e.css(this,&quot;position&quot;)&amp;&amp;(this.style.position=&quot;relative&quot;,e(this).data(&quot;blockUI.static&quot;,!0)),this.style.zoom=1,o(this,t)})},e.fn.unblock=function(o){return this[0]===window?(e.unblockUI(o),this):this.each(function(){t(this,o)})},e.blockUI.version=2.7,e.blockUI.defaults={message:&quot;&lt;h1&gt;Please wait...&lt;/h1&gt;&quot;,title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:&quot;30%&quot;,top:&quot;40%&quot;,left:&quot;35%&quot;,textAlign:&quot;center&quot;,color:&quot;#000&quot;,border:&quot;3px solid #aaa&quot;,backgroundColor:&quot;#fff&quot;,cursor:&quot;wait&quot;},themedCSS:{width:&quot;30%&quot;,top:&quot;40%&quot;,left:&quot;35%&quot;},overlayCSS:{backgroundColor:&quot;#000&quot;,opacity:.6,cursor:&quot;wait&quot;},cursorReset:&quot;default&quot;,growlCSS:{width:&quot;350px&quot;,top:&quot;10px&quot;,left:&quot;&quot;,right:&quot;10px&quot;,border:&quot;none&quot;,padding:&quot;5px&quot;,opacity:.6,cursor:&quot;default&quot;,color:&quot;#fff&quot;,backgroundColor:&quot;#000&quot;,&quot;-webkit-border-radius&quot;:&quot;10px&quot;,&quot;-moz-border-radius&quot;:&quot;10px&quot;,&quot;border-radius&quot;:&quot;10px&quot;},iframeSrc:/^https/i.test(window.location.href||&quot;&quot;)?&quot;javascript:false&quot;:&quot;about:blank&quot;,forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:&quot;:input:enabled:visible&quot;,onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:&quot;blockMsg&quot;,ignoreIfBlocked:!1};var b=null,p=[]}&quot;function&quot;==typeof define&amp;&amp;define.amd&amp;&amp;define.amd.jQuery?define([&quot;jquery&quot;],e):e(jQuery)})();
			
var j$ = jQuery.noConflict();

j$.blockUI({ message: &apos;&lt;b&gt;Sincronizando...&lt;/b&gt;&apos; });

function onSuccess(result){
	console.debug(result);
	j$.unblockUI();
	window.location.reload();
}

function onFailure(result){
	j$.unblockUI();
	alert(&apos;Erro encontrado: &apos; + result.faultstring);
}

var queryResult = sforce.connection.query(&quot;SELECT Id, Name, AccountLkp__r.CodeCustomerTxt__c FROM Invoice__c WHERE Id =&apos;{!Invoice__c.Id}&apos; limit 1&quot;);
console.debug(queryResult);

var invoice = queryResult.records;

var result = sforce.apex.execute(&quot;OrderService&quot;, &quot;getInvoiceList&quot;, 
		{
			invoiceNumber: invoice.Name,
			customerCode: invoice.AccountLkp__r.CodeCustomerTxt__c
		}, 
		{onSuccess: onSuccess, onFailure: onFailure});</url>
</WebLink>
