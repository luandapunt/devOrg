<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>CNPJWithPunctuationValidation</fullName>
    <active>true</active>
    <description>Valida os dígitos de verificação do CNPJ digitado com pontuação.</description>
    <errorConditionFormula>AND( NOT(ISNUMBER(CNPJTxt__c)), 
OR( 
OR(AND(MOD(( 
(VALUE(MID(CNPJTxt__c,1,1))*6)+ 
(VALUE(MID(CNPJTxt__c,2,1))*5)+ 
(VALUE(MID(CNPJTxt__c,4,1))*4)+ 
(VALUE(MID(CNPJTxt__c,5,1))*3)+ 
(VALUE(MID(CNPJTxt__c,6,1))*2)+ 
(VALUE(MID(CNPJTxt__c,8,1))*9)+ 
(VALUE(MID(CNPJTxt__c,9,1))*8)+ 
(VALUE(MID(CNPJTxt__c,10,1))*7)+ 
(VALUE(MID(CNPJTxt__c,12,1))*6)+ 
(VALUE(MID(CNPJTxt__c,13,1))*5)+ 
(VALUE(MID(CNPJTxt__c,14,1))*4)+ 
(VALUE(MID(CNPJTxt__c,15,1))*3)+ 
(VALUE(MID(CNPJTxt__c,17,1))*2) 
),11 
)&lt;=1 
,VALUE(MID(CNPJTxt__c,18,1))!=0 
) 
,AND(MOD(( 
(VALUE(MID(CNPJTxt__c,1,1))*6)+ 
(VALUE(MID(CNPJTxt__c,2,1))*5)+ 
(VALUE(MID(CNPJTxt__c,4,1))*4)+ 
(VALUE(MID(CNPJTxt__c,5,1))*3)+ 
(VALUE(MID(CNPJTxt__c,6,1))*2)+ 
(VALUE(MID(CNPJTxt__c,8,1))*9)+ 
(VALUE(MID(CNPJTxt__c,9,1))*8)+ 
(VALUE(MID(CNPJTxt__c,10,1))*7)+ 
(VALUE(MID(CNPJTxt__c,12,1))*6)+ 
(VALUE(MID(CNPJTxt__c,13,1))*5)+ 
(VALUE(MID(CNPJTxt__c,14,1))*4)+ 
(VALUE(MID(CNPJTxt__c,15,1))*3)+ 
(VALUE(MID(CNPJTxt__c,17,1))*2)) 
,11)&gt;1 
,(11-MOD(( 
(VALUE(MID(CNPJTxt__c,1,1))*6)+ 
(VALUE(MID(CNPJTxt__c,2,1))*5)+ 
(VALUE(MID(CNPJTxt__c,4,1))*4)+ 
(VALUE(MID(CNPJTxt__c,5,1))*3)+ 
(VALUE(MID(CNPJTxt__c,6,1))*2)+ 
(VALUE(MID(CNPJTxt__c,8,1))*9)+ 
(VALUE(MID(CNPJTxt__c,9,1))*8)+ 
(VALUE(MID(CNPJTxt__c,10,1))*7)+ 
(VALUE(MID(CNPJTxt__c,12,1))*6)+ 
(VALUE(MID(CNPJTxt__c,13,1))*5)+ 
(VALUE(MID(CNPJTxt__c,14,1))*4)+ 
(VALUE(MID(CNPJTxt__c,15,1))*3)+ 
(VALUE(MID(CNPJTxt__c,17,1))*2) 
) 
,11 
))!=VALUE(MID(CNPJTxt__c,18,1)) 
)), 
OR(AND(MOD(( 
(VALUE(MID(CNPJTxt__c,1,1))*6)+ 
(VALUE(MID(CNPJTxt__c,2,1))*5)+ 
(VALUE(MID(CNPJTxt__c,4,1))*4)+ 
(VALUE(MID(CNPJTxt__c,5,1))*3)+ 
(VALUE(MID(CNPJTxt__c,6,1))*2)+ 
(VALUE(MID(CNPJTxt__c,8,1))*9)+ 
(VALUE(MID(CNPJTxt__c,9,1))*8)+ 
(VALUE(MID(CNPJTxt__c,10,1))*7)+ 
(VALUE(MID(CNPJTxt__c,12,1))*6)+ 
(VALUE(MID(CNPJTxt__c,13,1))*5)+ 
(VALUE(MID(CNPJTxt__c,14,1))*4)+ 
(VALUE(MID(CNPJTxt__c,15,1))*3)+ 
(VALUE(MID(CNPJTxt__c,17,1))*2)) 
,11)&lt;=1 
,VALUE(MID(CNPJTxt__c,18,1))!=0) 
,AND(MOD(( 
(VALUE(MID(CNPJTxt__c,1,1))*6)+ 
(VALUE(MID(CNPJTxt__c,2,1))*5)+ 
(VALUE(MID(CNPJTxt__c,4,1))*4)+ 
(VALUE(MID(CNPJTxt__c,5,1))*3)+ 
(VALUE(MID(CNPJTxt__c,6,1))*2)+ 
(VALUE(MID(CNPJTxt__c,8,1))*9)+ 
(VALUE(MID(CNPJTxt__c,9,1))*8)+ 
(VALUE(MID(CNPJTxt__c,10,1))*7)+ 
(VALUE(MID(CNPJTxt__c,12,1))*6)+ 
(VALUE(MID(CNPJTxt__c,13,1))*5)+ 
(VALUE(MID(CNPJTxt__c,14,1))*4)+ 
(VALUE(MID(CNPJTxt__c,15,1))*3)+ 
(VALUE(MID(CNPJTxt__c,17,1))*2)) 
,11)&gt;1 
,(11-MOD(( 
(VALUE(MID(CNPJTxt__c,1,1))*6)+ 
(VALUE(MID(CNPJTxt__c,2,1))*5)+ 
(VALUE(MID(CNPJTxt__c,4,1))*4)+ 
(VALUE(MID(CNPJTxt__c,5,1))*3)+ 
(VALUE(MID(CNPJTxt__c,6,1))*2)+ 
(VALUE(MID(CNPJTxt__c,8,1))*9)+ 
(VALUE(MID(CNPJTxt__c,9,1))*8)+ 
(VALUE(MID(CNPJTxt__c,10,1))*7)+ 
(VALUE(MID(CNPJTxt__c,12,1))*6)+ 
(VALUE(MID(CNPJTxt__c,13,1))*5)+ 
(VALUE(MID(CNPJTxt__c,14,1))*4)+ 
(VALUE(MID(CNPJTxt__c,15,1))*3)+ 
(VALUE(MID(CNPJTxt__c,17,1))*2) 
),11 
))!=VALUE(MID(CNPJTxt__c,18,1)))) 
), 
NOT(ISBLANK(CNPJTxt__c)) 
)</errorConditionFormula>
    <errorDisplayField>CNPJTxt__c</errorDisplayField>
    <errorMessage>O CNPJ digitado não é válido.</errorMessage>
</ValidationRule>
